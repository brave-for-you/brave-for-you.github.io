<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Raspberry pi</title>
      <link href="/2024/04/16/centos-7.9/"/>
      <url>/2024/04/16/centos-7.9/</url>
      
        <content type="html"><![CDATA[<p>关于<a href="mailto:&#67;&#101;&#110;&#116;&#79;&#x73;&#64;&#x37;&#x2e;&#57;">&#67;&#101;&#110;&#116;&#79;&#x73;&#64;&#x37;&#x2e;&#57;</a> 初次使用注意以及基本内容，持续完善中…</p><h2 id="首次启动"><a href="#首次启动" class="headerlink" title="首次启动"></a>首次启动</h2><h3 id="新增用户"><a href="#新增用户" class="headerlink" title="新增用户"></a>新增用户</h3><pre><code class="shell">    adduser username    passwd username</code></pre><h3 id="关于yum、rpm基本命令"><a href="#关于yum、rpm基本命令" class="headerlink" title="关于yum、rpm基本命令"></a>关于yum、rpm基本命令</h3><pre><code class="shell">    yum install -y name    yum remove name    yum clean    yum localinstall rpm包地址    # 查询所有rpm包，grep筛选出包含mysql的内容    rpm -qa | grep mysql</code></pre><h3 id="python3-11-1安装"><a href="#python3-11-1安装" class="headerlink" title="python3.11.1安装"></a>python3.11.1安装</h3><pre><code class="shell">    # 下载文件到临时目录    cd /temp    wget https://www.python.org/ftp/python/3.11.1/Python-3.11.1.tgz    tar -xzf Python-3.11.1.tgz    # 安装依赖环境    yum -y install gcc zlib zlib-devel libffi libffi-devel    yum install readline-devel    yum install openssl-devel openssl11 openssl11-devel    export CFLAGS=$(pkg-config --cflags openssl11)    export LDFLAGS=$(pkg-config --libs openssl11)    # 进入下载文件解压地址    cd Python-3.11.1    # 指定安装路径    ./configure --prefix=/usr/bin/python3.11 --with-ssl    make    make install    # 软链指向    ln -s /usr/bin/python3.11/bin/python3 /usr/bin/python3    ln -s /usr/bin/python3.11/bin/pip3 /usr/bin/pip3</code></pre><h3 id="修改python默认版本软链指向"><a href="#修改python默认版本软链指向" class="headerlink" title="修改python默认版本软链指向"></a>修改python默认版本软链指向</h3><pre><code class="shell">    # 慎重修改， 部分系统安装是默认依赖版本是python2    sudo rm -rf /usr/bin/python    sudo ln -s /usr/bin/python3 /usr/bin/python</code></pre><h3 id="67-101-x6e-116-79-115-x40-55-x2e-x39-安装mysql"><a href="#67-101-x6e-116-79-115-x40-55-x2e-x39-安装mysql" class="headerlink" title="&#67;&#101;&#x6e;&#116;&#79;&#115;&#x40;&#55;&#x2e;&#x39; 安装mysql"></a><a href="mailto:&#67;&#101;&#x6e;&#116;&#79;&#115;&#x40;&#55;&#x2e;&#x39;">&#67;&#101;&#x6e;&#116;&#79;&#115;&#x40;&#55;&#x2e;&#x39;</a> 安装mysql</h3><pre><code class="shell">    # 检查历史版本    rpm -qa | grep -i mysql    rpm -qa | grep -i mariadb    # 卸载历史版本（如已安装过）    yum remove -y mysql安装包名称    yum remove -y mariadb安装包名称    # 清理残留数据目录及文件-示例    # 删除安装目录    whereis mysql    rm -rf /usr/lib64/mysql /usr/share/mysql    # 删除数据目录    rm -rf /var/lib/mysql    # 删除配置文件    rm -rf /etc/my.cnf    # 删除日志文件    rm -rf /var/log/mysql    rm -rf /var/log/mysqld.log    # 删除临时文件    rm -rf /tmp/mysql*    # 删除服务和启动脚本    rm -rf /etc/init.d/mysql    rm -rf /usr/lib/systemd/system/mysql.service    # 下载mysql官方yum源    wget  https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm    # 安装官方yum源    rpm -ivh mysql80-community-release-el7-3.noarch.rpm    # 清理yum缓存目录    yum clean all    # 重新上传yum缓存    yum makecache    # 导入GPG密钥（查看官方最新源https://repo.mysql.com/）    rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2023    # 安装mysql    yum install -y mysql-community-server mysql-community    mysql -V    # 查看临时初始密码    grep &#39;temporary password&#39; /var/log/mysqld.log</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Dev-Memos</title>
      <link href="/2024/03/26/dev-memos/"/>
      <url>/2024/03/26/dev-memos/</url>
      
        <content type="html"><![CDATA[<p>一些感觉有意思的代码片段记录，持续更新记录…</p><h2 id="加解密"><a href="#加解密" class="headerlink" title="加解密"></a>加解密</h2><h3 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h3><pre><code class="javascript">compileStr(code) &#123;  let c = String.fromCharCode(code.charCodeAt(0) + code.length)  for(let i = 1; i &lt; code.length; i++) &#123;    c += String.fromCharCode(code.charCodeAt(i) + code.charCodeAt(i - 1))  &#125;  return escape(c)&#125;</code></pre><h3 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h3><pre><code class="javascript">unCompileStr(str) &#123;  const code = unescape(str)  let c = String.fromCharCode(code.charCodeAt(0) - code.length)  for(let i = 1; i &lt; code.length; i++) &#123;    c += String.fromCharCode(code.charCodeAt(i) - c.charCodeAt(i - 1))  &#125;  return c&#125;</code></pre><h2 id="时间内容"><a href="#时间内容" class="headerlink" title="时间内容"></a>时间内容</h2><h3 id="时分秒倒计时（09-59-20）"><a href="#时分秒倒计时（09-59-20）" class="headerlink" title="时分秒倒计时（09:59:20）"></a>时分秒倒计时（09:59:20）</h3><pre><code class="javascript">// timeStamp为毫秒handleToSetTimerFn(timeStamp) &#123;    let timer = null    let t = timeStamp    let h = 0    let m = 0    let s = 0    h = Math.floor(t / (60 * 60))    h &lt; 10 &amp;&amp; (h = &quot;0&quot; + h)    m = Math.floor(t / 60 % 60)    m &lt; 10 &amp;&amp; (m = &quot;0&quot; + m)    s = Math.floor(t % 60)    let _thisTemp = this    timer = setInterval(() =&gt; &#123;        s--        s &lt; 10 &amp;&amp; (s = &quot;0&quot; + s)        if (s.length &gt;= 3) &#123;            s = 59            m = (Number(m) - 1)            m &lt; 10 &amp;&amp; (m = &quot;0&quot; + m)        &#125;        if (m.length &gt;= 3) &#123;            m = 59            h = (Number(h) - 1)            h &lt; 10 &amp;&amp; (h = &quot;0&quot; + h)        &#125;        if (h.length &gt;= 3) &#123;            h = &quot;00&quot;            m = &quot;00&quot;            s = &quot;00&quot;            clearInterval(timer)        &#125;        _thisTemp.timerStr = (h + &quot;:&quot; + m + &quot;:&quot; + s)    &#125;, 1000)&#125;</code></pre><h3 id="秒转换时分秒（10-00-00）"><a href="#秒转换时分秒（10-00-00）" class="headerlink" title="秒转换时分秒（10:00:00）"></a>秒转换时分秒（10:00:00）</h3><pre><code class="javascript">handleformatSeconds(value) &#123;  if(!value) &#123;    return 0  &#125;  let second = parseInt(value)  let minute = 0  let hour = 0  if (second &gt; 60) &#123;    minute = parseInt(second / 60)    second = parseInt(second % 60)    if (minute &gt; 60) &#123;      hour = parseInt(minute / 60)      minute = parseInt(minute % 60)    &#125;  &#125;  const result = (parseInt(hour) &gt;= 10 ? parseInt(hour) : &#39;0&#39; + parseInt(hour)) + &#39;:&#39; + (parseInt(minute) &gt;= 10 ? parseInt(minute) : &#39;0&#39; + parseInt(minute)) +&#39;:&#39;+ (parseInt(second) &gt;= 10 ? parseInt(second) : &#39;0&#39; + parseInt(second))  return result&#125;</code></pre><h3 id="时间范围与当前时间前后对比"><a href="#时间范围与当前时间前后对比" class="headerlink" title="时间范围与当前时间前后对比"></a>时间范围与当前时间前后对比</h3><pre><code class="javascript">_handleToCompareTime(tempStartTimeStr, tempEndTimeStr) &#123;    const tempStartTime = new Date(tempStartTimeStr).getTime()    const tempEndTime = new Date(tempEndTimeStr).getTime()    const thisTempTime = new Date().getTime()    if (thisTempTime &lt; tempStartTime) &#123;        console.log(Math.round((tempStartTime - thisTempTime) / 1000 / 60)) // 距离开始剩余时间（minute）        return -1 // 范围前    &#125; else if (thisTempTime &gt; tempStartTime &amp;&amp; thisTempTime &lt; tempEndTime) &#123;        console.log(Math.round((tempEndTime - thisTempTime) / 1000 / 60)) // 距离结束剩余时间（minute）        return 0 // 范围中    &#125; else &#123;        return 1 // 范围后    &#125;&#125;</code></pre><h3 id="判断对比输入日期与当前日期"><a href="#判断对比输入日期与当前日期" class="headerlink" title="判断对比输入日期与当前日期"></a>判断对比输入日期与当前日期</h3><pre><code class="javascript">_handleToCompareTime(dateString) &#123;  if (!dateString) &#123;    return false  &#125;  const currentDate = new Date() // 获取当前日期  const inputDate = new Date(dateString) // 将输入的日期字符串转换为Date对象  if (inputDate &gt; currentDate) &#123;    return false // 如果输入的日期大于当前日期  &#125;  return true // 输入日期小于或等于当前日期&#125;_handleToCompareTime(&#39;2024-05-01&#39;)</code></pre><h3 id="时间格式化"><a href="#时间格式化" class="headerlink" title="时间格式化"></a>时间格式化</h3><pre><code class="javascript">dateFormat(date, format) &#123;    const zeroPadding = (i) =&gt; &#123;        return (i &lt; 10 ? &#39;0&#39; : &#39;&#39;) + i    &#125;    return format.replace(/yyyy|MM|dd|HH|mm|ss/g, function (item) &#123;        switch (item) &#123;            case &#39;yyyy&#39;:                return zeroPadding(date.getFullYear())            case &#39;MM&#39;:                return zeroPadding(date.getMonth() + 1)            case &#39;dd&#39;:                return zeroPadding(date.getDate())            case &#39;HH&#39;:                return zeroPadding(date.getHours())            case &#39;mm&#39;:                return zeroPadding(date.getMinutes())            case &#39;ss&#39;:                return zeroPadding(date.getSeconds())        &#125;    &#125;)&#125;dateFormat(new Date(), &#39;yyyy-MM-dd HH:mm:ss&#39;)</code></pre><h3 id="时间格式化-一年前的时间"><a href="#时间格式化-一年前的时间" class="headerlink" title="时间格式化 一年前的时间"></a>时间格式化 一年前的时间</h3><pre><code class="javascript">oldDateFormat(date, format) &#123;    const zeroPadding = (i) =&gt; &#123;        return (i &lt; 10 ? &#39;0&#39; : &#39;&#39;) + i    &#125;    return format.replace(/yyyy|MM|dd|HH|mm|ss/g, function (item) &#123;        switch (item) &#123;            case &#39;yyyy&#39;:                return zeroPadding(date.getFullYear() - 1)            case &#39;MM&#39;:                return zeroPadding(date.getMonth() + 1)            case &#39;dd&#39;:                return zeroPadding(date.getDate())            case &#39;HH&#39;:                return zeroPadding(date.getHours())            case &#39;mm&#39;:                return zeroPadding(date.getMinutes())            case &#39;ss&#39;:                return zeroPadding(date.getSeconds())        &#125;    &#125;)&#125;dateFormat(new Date(), &#39;yyyy-MM-dd HH:mm:ss&#39;)</code></pre><h3 id="ElementUi日期组件"><a href="#ElementUi日期组件" class="headerlink" title="ElementUi日期组件"></a>ElementUi日期组件</h3><pre><code class="javascript">    // ElementUi组件禁用当前时间前2天后5天以外的内容    disabledDate: (date) =&gt; &#123;        return date.getTime() &lt; Date.now() - 2 * 24 * 60 * 60 * 1000 || date.getTime() &gt; Date.now() + 5 * 24 * 60 * 60 * 1000    &#125;</code></pre><h2 id="文件内容"><a href="#文件内容" class="headerlink" title="文件内容"></a>文件内容</h2><h3 id="文件流下载"><a href="#文件流下载" class="headerlink" title="文件流下载"></a>文件流下载</h3><pre><code class="javascript">handleReturnDownloadFile(content,filename) &#123;  let eleLink = document.createElement(&#39;a&#39;)  eleLink.download = filename  eleLink.style.display = &#39;none&#39;  // 字符内容转变成blob地址   let url= window.URL.createObjectURL(new Blob([data], &#123; type: &#39;application/octet-stream&#39; &#125;))  eleLink.href = url   // 自动触发点击   document.body.appendChild(eleLink)  eleLink.click()  // 然后移除   document.body.removeChild(eleLink)    //释放    window.URL.revokeObjectURL(url)&#125;</code></pre><h3 id="Base64转img"><a href="#Base64转img" class="headerlink" title="Base64转img"></a>Base64转img</h3><pre><code class="javascript">convertBase64UrlToBlob(urlData) &#123;  let bytes = window.atob(urlData)  // 处理异常,将ascii码小于0的转换为大于0  let ab = new ArrayBuffer(bytes.length)  let ia = new Uint8Array(ab)  for (let i = 0; i &lt; bytes.length; i++) &#123;    ia[i] = bytes.charCodeAt(i)  &#125;  return new Blob([ab], &#123;type: &#39;image/jpg&#39;&#125;)&#125;</code></pre><h3 id="img转Base64"><a href="#img转Base64" class="headerlink" title="img转Base64"></a>img转Base64</h3><pre><code class="javascript">convertBlobToBase64Url(file) &#123;    return new Promise((resolve, reject) =&gt; &#123;        let image = new Image()        image.src = URL.createObjectURL(file)        image.onload = () =&gt; &#123;            let canvas = document.createElement(&#39;canvas&#39;)            let content = canvas.getContext(&#39;2d&#39;)            canvas.width = image.width            canvas.height = image.height            content.drawImage(image, 0, 0, canvas.width, canvas.height)            resolve(canvas.toDataURL(file.type))            canvas.width = canvas.height = 0            content.fillRect(0, 0, 0, 0)            canvas = null            content = null            image = null        &#125;        image.onerror = (event, source, lineno, colno, error) =&gt; &#123;            if (error) &#123;                console.error(event, source, lineno, colno, error)                reject(error)                image = null            &#125;        &#125;    &#125;)&#125;</code></pre><h3 id="获取图片"><a href="#获取图片" class="headerlink" title="获取图片"></a>获取图片</h3><pre><code class="javascript">export function chooseImage(option) &#123;    try &#123;        const imageInput = document.createElement(&#39;input&#39;)        imageInput.type = &#39;file&#39;        imageInput.accept = &#39;image/*&#39;        if (option.sourceType === &#39;camera&#39;) &#123;            imageInput.capture = &#39;environment&#39;        &#125;        imageInput.style.height = &#39;0px&#39;        imageInput.style.width = &#39;0px&#39;        imageInput.style.position = &#39;fixed&#39;        imageInput.style.left = &#39;0px&#39;        imageInput.style.top = &#39;0px&#39;        imageInput.style.visibility = &#39;hidden&#39;        document.getElementsByTagName(&#39;body&#39;)[0].appendChild(imageInput)        imageInput.onchange = async function (e) &#123;            if (e.target.files.length) &#123;                let image = e.target.files[0]                let gifFlag = image.type.includes(&#39;gif&#39;)                // 设置了压缩但是图片为gif图片打印错误提示                if (option.compress &amp;&amp; gifFlag) &#123;                    console.log(&#39;\n&#39;)                    console.warn(&#39;前端不具备压缩gif动图的能力，请服务端处理&#39;);                    console.log(&#39;\n&#39;)                &#125;                // 不是gif图片 设置了压缩 并且 大于1.8M才会触发压缩                const compress = !gifFlag &amp;&amp; option.compress &amp;&amp; image.size &gt; 1572864                // 达到压缩条件开始压缩                if (compress) &#123;                    // 大于1.8M才会触发压缩                    image = await compressImageHandler(image)                &#125;                const result = &#123;                    file: image,                    name: image.name,                    size: image.size,                    path: !compress || gifFlag ? URL.createObjectURL(image) : await imageToBase64Handler(image),                    type: image.type,                &#125;                typeof option.success === &#39;function&#39; &amp;&amp; option.success(result)                typeof option.complete === &#39;function&#39; &amp;&amp; option.complete(result)                imageInput.remove()            &#125;        &#125;        imageInput.click()    &#125; catch (e) &#123;        typeof option.fail === &#39;function&#39; &amp;&amp; option.fail(e)        typeof option.complete === &#39;function&#39; &amp;&amp; option.complete(e)    &#125;&#125;chooseImage(&#123;  success: (data) =&gt; &#123;&#125;&#125;)</code></pre><h3 id="选取视频"><a href="#选取视频" class="headerlink" title="选取视频"></a>选取视频</h3><pre><code class="javascript">export function chooseVideo(option = &#123;&#125;) &#123;    try &#123;        const fileInput = document.createElement(&#39;input&#39;)        fileInput.type = &#39;file&#39;        fileInput.accept = &#39;video/*&#39;        if (option.sourceType === &#39;camera&#39;) &#123;            fileInput.capture = option.camera ? (option.camera === &#39;front&#39; ? &#39;user&#39; : &#39;environment&#39;) : &#39;user&#39;        &#125;        fileInput.style.height = &#39;0px&#39;        fileInput.style.width = &#39;0px&#39;        fileInput.style.position = &#39;fixed&#39;        fileInput.style.left = &#39;0px&#39;        fileInput.style.top = &#39;0px&#39;        fileInput.style.visibility = &#39;hidden&#39;        document.getElementsByTagName(&#39;body&#39;)[0].appendChild(fileInput)        fileInput.onchange = function (e) &#123;            if (e.target.files.length) &#123;                const file = e.target.files[0]                const result = &#123;                    file,                    name: file.name,                    size: file.size,                    path: URL.createObjectURL(file),                    type: file.type,                &#125;                typeof option.success === &#39;function&#39; &amp;&amp; option.success(result)                typeof option.complete === &#39;function&#39; &amp;&amp; option.complete(result)                fileInput.remove()            &#125;        &#125;        fileInput.click()    &#125; catch (e) &#123;        typeof option.fail === &#39;function&#39; &amp;&amp; option.fail(e)        typeof option.complete === &#39;function&#39; &amp;&amp; option.complete(e)    &#125;&#125;chooseVideo(&#123;  success: (data) =&gt; &#123;&#125;&#125;)</code></pre><h2 id="字符串内容"><a href="#字符串内容" class="headerlink" title="字符串内容"></a>字符串内容</h2><h3 id="数字校验"><a href="#数字校验" class="headerlink" title="数字校验"></a>数字校验</h3><pre><code class="javascript">const a = /[0-9]/.exec(Str) != null ? 1 : 0</code></pre><h3 id="字母校验"><a href="#字母校验" class="headerlink" title="字母校验"></a>字母校验</h3><pre><code class="javascript">const a = /[a-zA-Z]/.exec(Str) != null ? 1 : 0</code></pre><h3 id="营业执照统一信用编码校验"><a href="#营业执照统一信用编码校验" class="headerlink" title="营业执照统一信用编码校验"></a>营业执照统一信用编码校验</h3><pre><code class="javascript">const reg = /[0-9A-HJ-NPQRTUWXY]&#123;2&#125;\d&#123;6&#125;[0-9A-HJ-NPQRTUWXY]&#123;10&#125;/.exec(Str)</code></pre><h3 id="字节统计"><a href="#字节统计" class="headerlink" title="字节统计"></a>字节统计</h3><pre><code class="javascript">handleToCountStrLength(str) &#123;  let len = 0  for (let i = 0; i &lt; str.length; i++) &#123;     let c = str.charAt(i)    if (/^[\u0000-\u00ffA-Za-z1-9]+$/.test(c)) &#123;       len += 1    &#125; else &#123;       len += 2    &#125;   &#125;  return len&#125;</code></pre><h3 id="字符串转大写"><a href="#字符串转大写" class="headerlink" title="字符串转大写"></a>字符串转大写</h3><pre><code class="javascript">let str = &#39;abc&#39;str.toUpperCase()console.log(str) // ABC</code></pre><h3 id="键盘输入限制只有大写字母"><a href="#键盘输入限制只有大写字母" class="headerlink" title="键盘输入限制只有大写字母"></a>键盘输入限制只有大写字母</h3><pre><code class="javascript">//  @input=&quot;scope.row.accountNo = handleToCheckValFn(scope.row.accountNo)&quot;_handleToCheckValFn(val) &#123;  const regex = /^[A-Z]+$/ // 只填大写字母  // const regex = /^[0-9]+$/ // 只填数字  let tempStr = &quot;&quot;  for(let i in val) &#123;    if(regex.test(val[i])) &#123;      tempStr += val[i]    &#125;  &#125;  return tempStr&#125;</code></pre><h3 id="普通校验（手机号、邮箱、身份证号）"><a href="#普通校验（手机号、邮箱、身份证号）" class="headerlink" title="普通校验（手机号、邮箱、身份证号）"></a>普通校验（手机号、邮箱、身份证号）</h3><pre><code class="javascript">const validatePhone = (rule, value, callback = () =&gt; &#123;&#125;) =&gt; &#123;    if(!value) &#123;        return callback(new Error(&#39;手机号码不能为空！&#39;))    &#125;    if(!/^1[3456789]\d&#123;9&#125;$/.test(value)) &#123;        return callback(new Error(&#39;手机号码不正确！&#39;))    &#125;    return callback()&#125;const validateEmial = (rule, value, callback = () =&gt; &#123;&#125;) =&gt; &#123;    if(!value) &#123;        return callback(new Error(&#39;邮箱不能为空！&#39;))    &#125;    if(!/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(value)) &#123;        return callback(new Error(&#39;邮箱格式不正确！&#39;))    &#125;    return callback()&#125;const validateIdCard = (rule, value, callback = () =&gt; &#123;&#125;) =&gt; &#123;    if(!value) &#123;        return callback(new Error(&#39;身份证号不能为空！&#39;))    &#125;    if(!/^[1-9]\d&#123;5&#125;(?:18|19|20|21|22)\d&#123;2&#125;(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\d|30|31)\d&#123;3&#125;[$/.test(value)) &#123;        return callback(new Error(&#39;身份证号不正确！&#39;))    &#125;    return callback()&#125;</code></pre><h3 id="首字母大写"><a href="#首字母大写" class="headerlink" title="首字母大写"></a>首字母大写</h3><pre><code class="javascript">export function firstChartToUpperCase(str) &#123;    if (typeof str === &#39;string&#39;) &#123;        return str.charAt(0).toUpperCase() + str.substr(1)    &#125;    return str&#125;</code></pre><h3 id="字符串转驼峰"><a href="#字符串转驼峰" class="headerlink" title="字符串转驼峰"></a>字符串转驼峰</h3><pre><code class="javascript">export function stringTurnHump(str, symbol = &#39;-&#39;) &#123;    if (typeof str === &#39;string&#39;) &#123;        return str.split(symbol).map((value, index) =&gt; (index &gt; 0 ? firstChartToUpperCase(value) : value)).join(&#39;&#39;)    &#125;    return str&#125;</code></pre><h3 id="css字符串转JS对象"><a href="#css字符串转JS对象" class="headerlink" title="css字符串转JS对象"></a>css字符串转JS对象</h3><pre><code class="javascript">export function stringTurnObjectForCSS(cssString) &#123;    if (cssString) &#123;        return Object.fromEntries(cssString.split(&#39;;&#39;).map((value) =&gt; value.split(&#39;:&#39;).map((val, index) =&gt; (index === 0 ? stringTurnHump(val) : val))))    &#125;    return cssString&#125;</code></pre><h3 id="手机号脱敏"><a href="#手机号脱敏" class="headerlink" title="手机号脱敏"></a>手机号脱敏</h3><pre><code class="javascript">export function formatPhone(phoneNumber) &#123;    const result = checkPhoneNumber(phoneNumber)    if (result.success) &#123;        return phoneNumber.toString().replace(/(.&#123;4&#125;)(.&#123;4&#125;)(.&#123;3&#125;)/, &#39;$1****$3&#39;)    &#125;    return result.message&#125;</code></pre><h3 id="脱敏银行卡号"><a href="#脱敏银行卡号" class="headerlink" title="脱敏银行卡号"></a>脱敏银行卡号</h3><pre><code class="javascript">export function desensitizeBankCardNumber(cardNumber) &#123;    const str = String(cardNumber)    return str.substring(str.length - 4)&#125;</code></pre><h3 id="金额转换千分位格式"><a href="#金额转换千分位格式" class="headerlink" title="金额转换千分位格式"></a>金额转换千分位格式</h3><pre><code class="javascript">/** * 金额转换千分位格式 * @param money 需转换的金额 * @param fixedLength &#123;number|null&#125; 保留几位小数 false 不处理 * @returns &#123;string|*&#125; */export function convertThousandth(money, fixedLength = null) &#123;    if (isNaN(Number(money))) &#123;        return money    &#125;    let _money = Number(money).toString()    if (typeof fixedLength === &#39;number&#39; &amp;&amp; !isNaN(fixedLength)) &#123;        _money = toFixed(money, fixedLength)    &#125;    if (_money.indexOf(&#39;.&#39;) === -1) &#123;        return _money.replace(/\B(?=(?:\d&#123;3&#125;)+\b)/g, &#39;,&#39;)    &#125;    return _money.replace(/(\d)(?=(\d&#123;3&#125;)+\.)/g, &#39;$1,&#39;)&#125;</code></pre><h3 id="身份证号校验（号码-区号）"><a href="#身份证号校验（号码-区号）" class="headerlink" title="身份证号校验（号码+区号）"></a>身份证号校验（号码+区号）</h3><pre><code class="javascript">const areaCode = &#39;1100,1101,1102,1200,1201,1202,1300,1301,1302,1303,1304,1305,1306,1307,1308,1309,1310,1311,1400,1401,1402,1403,1404,1405,1406,1407,1408,1409,1410,1411,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1522,1525,1526,1529,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2111,2112,2113,2114,2200,2201,2202,2203,2204,2205,2206,2207,2208,2224,2300,2301,2302,2303,2304,2305,2306,2307,2308,2309,2310,2311,2312,2327,3100,3101,3102,3200,3201,3202,3203,3204,3205,3206,3207,3208,3209,3210,3211,3212,3213,3300,3301,3302,3303,3304,3305,3306,3307,3308,3309,3310,3311,3400,3401,3402,3403,3404,3405,3406,3407,3408,3410,3411,3412,3413,3414,3415,3416,3417,3418,3500,3501,3502,3503,3504,3505,3506,3507,3508,3509,3600,3601,3602,3603,3604,3605,3606,3607,3608,3609,3610,3611,3700,3701,3702,3703,3704,3705,3706,3707,3708,3709,3710,3711,3712,3713,3714,3715,3716,3717,4100,4101,4102,4103,4104,4105,4106,4107,4108,4109,4110,4111,4112,4113,4114,4115,4116,4117,4200,4201,4202,4203,4205,4206,4207,4208,4209,4210,4211,4212,4213,4228,4290,4300,4301,4302,4303,4304,4305,4306,4307,4308,4309,4310,4311,4312,4313,4331,4400,4401,4402,4403,4404,4405,4406,4407,4408,4409,4412,4413,4414,4415,4416,4417,4418,4419,4420,4451,4452,4453,4500,4501,4502,4503,4504,4505,4506,4507,4508,4509,4510,4511,4512,4513,4514,4600,4601,4602,4690,5000,5001,5002,5003,5100,5101,5103,5104,5105,5106,5107,5108,5109,5110,5111,5113,5114,5115,5116,5117,5118,5119,5120,5132,5133,5134,5200,5201,5202,5203,5204,5222,5223,5224,5226,5227,5300,5301,5303,5304,5305,5306,5307,5308,5309,5323,5325,5326,5328,5329,5331,5333,5334,5400,5401,5421,5422,5423,5424,5425,5426,6100,6101,6102,6103,6104,6105,6106,6107,6108,6109,6110,6200,6201,6202,6203,6204,6205,6206,6207,6208,6209,6210,6211,6226,6229,6230,6300,6301,6321,6322,6323,6325,6326,6327,6328,6400,6401,6402,6403,6404,6405,6500,6501,6502,6521,6522,6523,6527,6528,6529,6530,6531,6532,6540,6542,6543,6590,7100,8100,8200&#39;const validateIdCard = (rule, value, callback = () =&gt; &#123;&#125;) =&gt; &#123;  if(!value) &#123;    return callback(new Error(&#39;身份证号不能为空！&#39;))  &#125;  if(!/^[1-9]\d&#123;5&#125;(?:18|19|20|21|22)\d&#123;2&#125;(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\d|30|31)\d&#123;3&#125;[\dX]$/.test(value)) &#123;      return callback(new Error(&#39;身份证号不正确！&#39;))  &#125;  // 前4位区号有效验证  if(!areaCode.includes(value.slice(0, 3))) &#123;    return callback(new Error(&#39;身份证号不正确！&#39;))  &#125;  return callback()&#125;</code></pre><h3 id="根据身份证号计算内容"><a href="#根据身份证号计算内容" class="headerlink" title="根据身份证号计算内容"></a>根据身份证号计算内容</h3><pre><code class="javascript">computeIdCardFn(IdCard, type) &#123;  if(!IdCard) &#123;    return &#39;&#39;  &#125;  if (type === 1) &#123;    //获取出生日期    let birthday = IdCard.substring(6, 10) + &#39;-&#39; + IdCard.substring(10, 12) + &#39;-&#39; + IdCard.substring(12, 14)    return birthday  &#125;  if (type === 2) &#123;    let sex = &#39;&#39;    //获取性别    if (parseInt(IdCard.substr(16, 1)) % 2 === 1) &#123;      sex = &#39;男&#39;    &#125;else &#123;      sex = &#39;女&#39;    &#125;    return sex  &#125;  if (type === 3) &#123;    //获取年龄    let ageDate = new Date()    let month = ageDate.getMonth() + 1    let day = ageDate.getDate()    let age = ageDate.getFullYear() - IdCard.substring(6, 10) - 1    if (IdCard.substring(10, 12) &lt; month || IdCard.substring(10, 12) === month &amp;&amp; IdCard.substring(12, 14) &lt;= day) &#123;      age++    &#125;    if (age &lt;= 0) &#123;      age = 1    &#125;    return age  &#125;&#125;</code></pre><h2 id="VUE加载自动触发元素点击事件"><a href="#VUE加载自动触发元素点击事件" class="headerlink" title="VUE加载自动触发元素点击事件"></a>VUE加载自动触发元素点击事件</h2><h3 id="SubTemplate"><a href="#SubTemplate" class="headerlink" title="SubTemplate"></a>SubTemplate</h3><pre><code class="javascript">directives: &#123;  trigger: &#123;    triggerFlag: false,    inserted(el,binging) &#123;      if(binging.def.triggerFlag) &#123;        return      &#125;      el.click()      binging.def.triggerFlag = true    &#125;  &#125;&#125;,methods: &#123;&#125;,</code></pre><h2 id="Javascript数组内容"><a href="#Javascript数组内容" class="headerlink" title="Javascript数组内容"></a>Javascript数组内容</h2><h3 id="filter"><a href="#filter" class="headerlink" title="filter()"></a>filter()</h3><pre><code class="javascript">// 过滤let numArr = [0, 1, 2, 3, 4, 5, 6, 7]let res = numArr.filter(num =&gt; num &gt;= 5)console.log(res) // [5, 6, 7]</code></pre><h3 id="重复判断"><a href="#重复判断" class="headerlink" title="重复判断"></a>重复判断</h3><pre><code class="javascript">// 判断数组中是否有重复内容let tempArr = [1, 2, 2, 3]Array.from(new Set(tempArr)).length &lt; tempArr.length</code></pre><h3 id="数组内容移动"><a href="#数组内容移动" class="headerlink" title="数组内容移动"></a>数组内容移动</h3><pre><code class="javascript">// 上移this.tempArr[index] = this.tempArr.splice(index - 1, 1, this.tempArr[index])[0]// 下移this.tempArr[index] = this.tempArr.splice(index + 1, 1, this.tempArr[index])[0]</code></pre><h2 id="页面事件监听"><a href="#页面事件监听" class="headerlink" title="页面事件监听"></a>页面事件监听</h2><h3 id="监听离开"><a href="#监听离开" class="headerlink" title="监听离开"></a>监听离开</h3><pre><code class="javascript">fn() &#123;    // 离开时监听触发&#125;// PC端window.addEventListener(&#39;blur&#39;, this.fn)window.removeEventListener(&#39;blur&#39;, this.fn)// 移动端window.addEventListener(&#39;visibilitychange&#39;, this.fn)window.removeEventListener(&#39;visibilitychange&#39;, this.fn)</code></pre><h2 id="Css内容"><a href="#Css内容" class="headerlink" title="Css内容"></a>Css内容</h2><h3 id="线性渐变背景颜色"><a href="#线性渐变背景颜色" class="headerlink" title="线性渐变背景颜色"></a>线性渐变背景颜色</h3><pre><code class="css">/* css线性渐变背景颜色 */background: linear-gradient(to right , #ffce7b, #ff6609);</code></pre><h3 id="右上角三角标"><a href="#右上角三角标" class="headerlink" title="右上角三角标"></a>右上角三角标</h3><pre><code class="css">/* css右上角三角标 */background-image: linear-gradient(225deg, #f44336 20%, #00dd00 20%);</code></pre><h2 id="移动端Debug"><a href="#移动端Debug" class="headerlink" title="移动端Debug"></a>移动端Debug</h2><pre><code class="html">&lt;script src=&quot;https://unpkg.com/vconsole@latest/dist/vconsole.min.js&quot;&gt;&lt;/script&gt;&lt;script&gt;     // VConsole 默认会挂载到 `window.VConsole` 上    var vConsole = new window.VConsole();&lt;/script&gt;</code></pre><h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><pre><code class="sh">    # 生成公钥私钥配对    $ ssh-keygen -t ed25519 -C &quot;邮箱&quot;    # git基础信息设置    $ git config --global user.name &quot;&quot;    $ git config --global user.email &quot;&quot;</code></pre><h2 id="正则"><a href="#正则" class="headerlink" title="正则"></a>正则</h2><hr><pre><code>. - 除换行符以外的所有字符。^ - 字符串开头。$ - 字符串结尾。\d, \w, \s - 匹配数字、字符、空格。\D, \W, \S - 匹配非数字、非字符、非空格。[abc] - 匹配 a、b 或 c 中的一个字母。[a-z] - 匹配 a 到 z 中的一个字母。[^abc] - 匹配除了 a、b 或 c 中的其他字母。aa|bb - 匹配 aa 或 bb。? - 0 次或 1 次匹配。* - 匹配 0 次或多次。+ - 匹配 1 次或多次。&#123;n&#125; - 匹配 n次。&#123;n, &#125; - 匹配 n次以上。&#123;m, n&#125; - 最少 m 次，最多 n 次匹配。(expr) - 捕获 expr 子模式,以 \1 使用它。(?:expr) - 忽略捕获的子模式。(?=expr) - 正向预查模式 expr。(?!expr) - 负向预查模式 expr。</code></pre><hr>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DrissionPage</title>
      <link href="/2023/12/21/drissionpage/"/>
      <url>/2023/12/21/drissionpage/</url>
      
        <content type="html"><![CDATA[<p>DrissionPage 是一个基于 python 的网页自动化工具。<br>它既能控制浏览器，也能收发数据包，还能把两者合而为一。<br>可兼顾浏览器自动化的便利性和 requests 的高效率。<br>它功能强大，内置无数人性化设计和便捷功能。<br>它的语法简洁而优雅，代码量少，对新手友好。</p><h2 id="1-运行环境"><a href="#1-运行环境" class="headerlink" title="1. 运行环境"></a>1. 运行环境</h2><p>操作系统：Windows、Linux 或 Mac。<br>python 版本：3.6 及以上<br>支持浏览器：Chromium 内核（如 Chrome 和 Edge）</p><h2 id="2-pip安装及升级"><a href="#2-pip安装及升级" class="headerlink" title="2. pip安装及升级"></a>2. pip安装及升级</h2><pre><code class="shell">pip install DrissionPage # pip安装DrissionPagepip install DrissionPage --upgrade # pip升级DrissionPage</code></pre><h2 id="3-基本内容"><a href="#3-基本内容" class="headerlink" title="3. 基本内容"></a>3. 基本内容</h2><p>页面类用于控制浏览器，或收发数据包，是最主要的工具。DrissionPage 包含三种主要页面类。根据须要在其中选择使用。</p><h3 id="3-1-WebPage"><a href="#3-1-WebPage" class="headerlink" title="3.1 WebPage"></a>3.1 WebPage</h3><pre><code>功能最全面的页面类，既可控制浏览器，也可收发数据包(包含了ChromiumPage和SessionPage)通过change_mode()方法切换模式(ChromiumPage: &#39;d&#39;, SessionPage: &#39;s&#39;)```pythonfrom DrissionPage import WebPage```</code></pre><h3 id="3-2-ChromiumPage"><a href="#3-2-ChromiumPage" class="headerlink" title="3.2 ChromiumPage"></a>3.2 ChromiumPage</h3><pre><code>用于只控制浏览器```pythonfrom DrissionPage import ChromiumPage```</code></pre><h3 id="3-3-SessionPage"><a href="#3-3-SessionPage" class="headerlink" title="3.3 SessionPage"></a>3.3 SessionPage</h3><pre><code>用于只收发数据包```pythonfrom DrissionPage import SessionPage```</code></pre><h2 id="4-配置工具"><a href="#4-配置工具" class="headerlink" title="4. 配置工具"></a>4. 配置工具</h2><p>很多时候我们须要设置启动参数，可导入以下两个类，但不是必须的。</p><h3 id="4-1-ChromiumOptions类"><a href="#4-1-ChromiumOptions类" class="headerlink" title="4.1 ChromiumOptions类"></a>4.1 ChromiumOptions类</h3><pre><code>用于设置浏览器启动参数```pythonfrom DrissionPage import ChromiumOptions```</code></pre><h3 id="4-2-SessionOptions类"><a href="#4-2-SessionOptions类" class="headerlink" title="4.2 SessionOptions类"></a>4.2 SessionOptions类</h3><pre><code>用于设置Session对象启动参数```pythonfrom DrissionPage import SessionOptions```</code></pre><h3 id="4-3-Settings"><a href="#4-3-Settings" class="headerlink" title="4.3 Settings"></a>4.3 Settings</h3><pre><code>用于设置全局配置```pythonfrom DrissionPage.common import Settings```</code></pre><h2 id="5-其他工具"><a href="#5-其他工具" class="headerlink" title="5. 其他工具"></a>5. 其他工具</h2><p>可能需要用到的工具，需要时可以导入。</p><h3 id="5-1-动作链"><a href="#5-1-动作链" class="headerlink" title="5.1 动作链"></a>5.1 动作链</h3><pre><code>用于模拟一系列键盘和鼠标的操作```pythonfrom DrissionPage.common import ActionChains```</code></pre><h3 id="5-2-键盘按键类"><a href="#5-2-键盘按键类" class="headerlink" title="5.2 键盘按键类"></a>5.2 键盘按键类</h3><pre><code>用于键入 ctrl、alt 等按键```pythonfrom DrissionPage.common import Keys```</code></pre><h3 id="5-3-By类"><a href="#5-3-By类" class="headerlink" title="5.3 By类"></a>5.3 By类</h3><pre><code>便于项目迁移```pythonfrom DrissionPage.common import By```</code></pre><h3 id="5-4-浏览器数据包监听器"><a href="#5-4-浏览器数据包监听器" class="headerlink" title="5.4 浏览器数据包监听器"></a>5.4 浏览器数据包监听器</h3><pre><code>```pythonfrom DrissionPage.common import Listener, RequestMan```</code></pre><h3 id="5-5-easy-set"><a href="#5-5-easy-set" class="headerlink" title="5.5 easy_set"></a>5.5 easy_set</h3><pre><code>保存了一些便捷的 ini 文件设置方法，可选择使用```pythonfrom DrissionPage.easy_set import *```</code></pre><h2 id="6-导入异常"><a href="#6-导入异常" class="headerlink" title="6. 导入异常"></a>6. 导入异常</h2><pre><code>异常放在以下路径```pythonfrom DrissionPage.errors import ElementNotFoundError```</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Django</title>
      <link href="/2023/11/10/django/"/>
      <url>/2023/11/10/django/</url>
      
        <content type="html"><![CDATA[<p>关于Python的服务端框架-Django(有大量的基础服务内容，可创建多模块分配)。当前使用环境：python –version 3.11.1、pip –version 23.3.1。</p><h2 id="安装Django-及-其他依赖包"><a href="#安装Django-及-其他依赖包" class="headerlink" title="安装Django 及 其他依赖包"></a>安装Django 及 其他依赖包</h2><pre><code class="shell">pip install django # 框架依赖包 version 4.2.7pip install django-cors-headers # 处理跨域的依赖包pip install pymysql # mysql模块依赖包</code></pre><h2 id="依赖记录"><a href="#依赖记录" class="headerlink" title="依赖记录"></a>依赖记录</h2><pre><code class="shell"># 创建依赖记录pip freeze &gt; requirements.txt# 依赖记录安装pip install -r requirements.txt</code></pre><h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><pre><code class="shell">Django-admin startproject templateName</code></pre><h2 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h2><h3 id="处理跨域访问"><a href="#处理跨域访问" class="headerlink" title="处理跨域访问"></a>处理跨域访问</h3><pre><code class="python"># 基础配置文件配置以下内容ALLOWED_HOSTS = [&#39;*&#39;]CORS_ALLOW_CREDENTIALS = TrueCORS_ORIGIN_ALLOW_ALL = TrueCORS_ORIGIN_WHITELIST = (&#39;http://localhost&#39;, &#39;http://127.0.0.1&#39;, &#39;http://0.0.0.0&#39;)SECURE_CROSS_ORIGIN_OPENER_POLICY = None # 默认值为same-originCORS_ALLOW_METHODS = (    &#39;DELETE&#39;,    &#39;GET&#39;,    &#39;OPTIONS&#39;,    &#39;PATCH&#39;,    &#39;POST&#39;,    &#39;PUT&#39;,    &#39;VIEW&#39;,)CORS_ALLOW_HEADERS = (&#39;*&#39;,)</code></pre><h3 id="模块创建"><a href="#模块创建" class="headerlink" title="模块创建"></a>模块创建</h3><pre><code class="shell">python manage.py startapp AppOne # 创建AppOne模块python manage.py startapp AppTwo # 创建AppTwo模块</code></pre><h3 id="模块注册"><a href="#模块注册" class="headerlink" title="模块注册"></a>模块注册</h3><pre><code class="python"># 模块创建完成后需要注册INSTALLED_APPS = [    &#39;django.contrib.admin&#39;,    &#39;django.contrib.auth&#39;,    &#39;django.contrib.contenttypes&#39;,    &#39;django.contrib.sessions&#39;,    &#39;django.contrib.messages&#39;,    &#39;django.contrib.staticfiles&#39;,    &#39;AppOne.apps.ApponeConfig&#39;, #注册AppOne    &#39;AppTwo.apps.ApptwoConfig&#39;, #注册AppTwo]</code></pre><h3 id="数据库配置"><a href="#数据库配置" class="headerlink" title="数据库配置"></a>数据库配置</h3><pre><code class="python"># __init__.pyimport pymysql  # 导入第三方模块，用来操作mysql数据库pymysql.install_as_MySQLdb()# settings.pyDATABASES = &#123;    &#39;default&#39;: &#123;        # django默认数据库        &#39;ENGINE&#39;: &#39;django.db.backends.sqlite3&#39;,        &#39;NAME&#39;: BASE_DIR / &#39;db.sqlite3&#39;,        # mysql远程数据库        # &#39;ENGINE&#39;: &#39;django.db.backends.mysql&#39;, # 更改为mysql        # &#39;NAME&#39;: &#39;example&#39;, # testsql数据库名        # &#39;USER&#39;: &#39;example&#39;, # 数据库的用户名        # &#39;PASSWORD&#39;: &#39;example123&#39;, # 密码        # &#39;HOST&#39;: &#39;*.*.*.*&#39;,        # &#39;PORT&#39;: &#39;3306&#39;, # 端口号，默认为3306    &#125;&#125;</code></pre><h3 id="Django模型"><a href="#Django模型" class="headerlink" title="Django模型"></a>Django模型</h3><pre><code class="python"># 定义AppOne的模型  /&gt;AppOne&gt;models.pyfrom django.db import models# Create your models here.class Book(models.Model):    id = models.AutoField(primary_key=True) # id 会自动创建,可以手动写入    title = models.CharField(max_length=32) # 书籍名称    price = models.DecimalField(max_digits=5, decimal_places=2) # 书籍价格    publish = models.CharField(max_length=32) # 出版社名称    pub_date = models.DateField() # 出版时间</code></pre><pre><code class="shell">python manage.py makemigrations AppOne # 映射AppOne的modelspython manage.py migrate 同步AppOne的models到数据库</code></pre><h3 id="后台管理员配置"><a href="#后台管理员配置" class="headerlink" title="后台管理员配置"></a>后台管理员配置</h3><pre><code class="shell"># 需要先映射同步数据库python manage.py makemigrations 映射modelspython manage.py migrate 同步到数据库# 创建超级用户python manage.py createsuperuser# http://ip:端口/admin/ 访问后台</code></pre><h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><pre><code class="shell">python manage.py runserver 0.0.0.0:5000 # 启动到局域网内5000端口python manage.py runserver 127.0.0.1:5000 # 启动到本地5000端口</code></pre><h2 id="路由配置"><a href="#路由配置" class="headerlink" title="路由配置"></a>路由配置</h2><pre><code class="python"># urls.pyfrom django.urls import path, include # include用于多项目时分发from django.contrib import adminurlpatterns = [    path(&#39;admin/&#39;, admin.site.urls),    path(&quot;user/&quot;, include(&quot;user.urls&quot;)),]</code></pre><h2 id="模块视图"><a href="#模块视图" class="headerlink" title="模块视图"></a>模块视图</h2><h3 id="子路由配置"><a href="#子路由配置" class="headerlink" title="子路由配置"></a>子路由配置</h3><pre><code class="python"># /&gt;AppOne&gt;urls.pyfrom django.urls import pathfrom django.urls import re_path # 用re_path 需要引入from AppOne import viewsurlpatterns = [    path(&#39;search/&#39;, views.searchUser), # 普通路径    re_path(r&#39;^index1/([0-9]&#123;4&#125;)/$&#39;, views.index1), # 正则路径（无名分组）http://127.0.0.1:5000/user/index1/2023/    re_path(&quot;^index2/(?P&lt;year&gt;[0-9]&#123;4&#125;)/(?P&lt;month&gt;[0-9]&#123;2&#125;)/$&quot;, views.index2), # 正则路径（路由形参）http://127.0.0.1:5000/user/index2/2023/05/    # r:代表的是原生字符串（raw）    # ^:代表以什么开头    # $:代表的是以什么结尾    # /article/list/(year)/    # 在正则表达式中定义一个变量，参数，就需要用（）进行捕获参数。    # 给捕获的参数去一个名字，就可以使用&lt;&gt;,（?P&lt;year&gt;）    # \d:代表是0-9之间的数字    # &#123;4&#125;：代表的是这样的数字有4个。    # 在我们的$符号前面有一个/，代表的是要以/结尾。]</code></pre><h3 id="子模型注册Admin"><a href="#子模型注册Admin" class="headerlink" title="子模型注册Admin"></a>子模型注册Admin</h3><pre><code class="python"># /&gt;AppOne&gt;admin.pyfrom django.contrib import adminfrom user.models import Book # Register your models here.admin.site.register([Book])</code></pre><h3 id="视图内容"><a href="#视图内容" class="headerlink" title="视图内容"></a>视图内容</h3><pre><code class="python"># /&gt;AppOne&gt;views.pyfrom django.shortcuts import render# Create your views here.from django.http import HttpResponse, JsonResponsefrom django.core import serializers # 格式化json serializers.serialize(&quot;json&quot;, models.Book.objects.all())from user import modelsimport jsondef searchUser(request):    # 请求接口返回示例    if request.method == &quot;GET&quot;:        # GET        name = request.GET.get(&#39;name&#39;)        return HttpResponse(&quot;user：&quot; + name)    elif request.method == &quot;POST&quot;:        # POST        name = request.POST.get(&#39;name&#39;)        return HttpResponse(&quot;user：&quot; + name)  # 字符串作为返回内容    def index1(request, year):    # 请求接口返回示例    return HttpResponse(year) # 一个形参代表路径中一个分组的内容，按关键字对应匹配def index2(request, year, month):    # 请求接口返回示例    return HttpResponse(year + &#39;-&#39; + month) # 一个形参代表路径中一个分组的内容，按关键字对应匹配</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Raspberry pi</title>
      <link href="/2023/10/16/raspberry-pi/"/>
      <url>/2023/10/16/raspberry-pi/</url>
      
        <content type="html"><![CDATA[<p>关于Raspberry 初次使用注意以及基本内容，持续完善中…</p><h2 id="系统烧录"><a href="#系统烧录" class="headerlink" title="系统烧录"></a>系统烧录</h2><pre><code>    1. 解压下载的系统压缩文件，得到img镜像文件    2. 将SD使用卡托或者读卡器后，连上电脑    3. 解压并运行win32diskimager工具（需要先格式化SD卡）    4. 在软件中选择img（镜像）文件，“Device”下选择SD的盘符，然后选择“Write”    # 然后就开始安装系统了，根据你的SD速度，安装过程有快有慢。    ps：树莓派官网提供的烧录工具选择更多点 https://www.raspberrypi.com/software/</code></pre><h2 id="首次开机"><a href="#首次开机" class="headerlink" title="首次开机"></a>首次开机</h2><h3 id="关于账号"><a href="#关于账号" class="headerlink" title="关于账号"></a>关于账号</h3><pre><code class="shell">    # 用户名：pi    # 密码：yahboom / raspberry    # root用户原始系统是没有开启的，自己设置密码就可以    sudo passwd root # 输入两次密码确认    sudo passwd --unlock root # 解锁root用户    # 切换root：    su # 确认后输入密码</code></pre><h3 id="进入后界面操作"><a href="#进入后界面操作" class="headerlink" title="进入后界面操作"></a>进入后界面操作</h3><pre><code class="shell">    # 打开树莓派系统下的命令行终端（Ctrl+Alt+T）        ifconfig # 查看我们的ip地址    sudo raspi-config # 进入到树莓派系统配置界面</code></pre><h3 id="关于几个常用命令"><a href="#关于几个常用命令" class="headerlink" title="关于几个常用命令"></a>关于几个常用命令</h3><pre><code class="shell">    # 查看操作系统版本    cat /proc/version    # 查看主板版本    cat /proc/cpuinfo    # 查看SD存储卡剩余空间    df -h    # 查看ip地址    ifconfig    # 压缩    tar –zcvf  filename.tar.gz dirname    # 解压    tar –zxvf filename.tar.gz    # Linux更改文件权限（递归子集）    chmod -R 777 /home/test</code></pre><h2 id="关机注意"><a href="#关机注意" class="headerlink" title="关机注意"></a>关机注意</h2><pre><code class="shell">    # 不能直接拔掉电源，会造成树莓派数据无法及时保存而丢失    # 可以按需选择相关的终端命令操作    sudo poweroff # 关闭电源    sudo shutdown -h now # 立刻关机    sudo shutdown -r now # 立刻重启    sudo reboot # 重启    sudo shutdown -h +2 # 2分钟之后关机</code></pre><h2 id="关于pi安装问题"><a href="#关于pi安装问题" class="headerlink" title="关于pi安装问题"></a>关于pi安装问题</h2><h3 id="apt-get基本命令"><a href="#apt-get基本命令" class="headerlink" title="apt-get基本命令"></a>apt-get基本命令</h3><pre><code class="shell"># apt-get可简写apt    # 更新源文件    sudo apt-get update    # 升级所有已安装的包    sudo apt-get upgrade    # 清理无用的包    sudo apt-get autoclean    # 检查是否有损坏的依赖    sudo apt-get check    # 安装     sudo apt-get install _name_    # 移除    sudo apt-get remove _name_    # 删除包，包括配置文件    sudo apt-get remove _name_ --purge    # 删除包，包括包及其依赖的软件、配置文件    sudo apt-get autoremove _name_ --purge</code></pre><h3 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h3><pre><code class="shell">    # 下面两个源都可使用    # deb https://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main contrib non-free rpi    # deb https://mirrors.ustc.edu.cn/raspbian/raspbian/ buster main contrib non-free rpi    sudo nano /etc/apt/sources.list # 进入该配置文件更换源    sudo apt update # 配置完成后执行该命令使生效</code></pre><h3 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h3><pre><code class="shell">    # 树莓派无法直接安装mysql，建议使用 mariadb-server-10.0 ，用法一致    sudo apt-get install mariadb-server-10.0</code></pre><h3 id="解决无密码可登录mysql的问题"><a href="#解决无密码可登录mysql的问题" class="headerlink" title="解决无密码可登录mysql的问题"></a>解决无密码可登录mysql的问题</h3><pre><code class="shell">    # 进入mysql后执行    SET password for &#39;root&#39;@&#39;localhost&#39;=password(&#39;123456&#39;); # 设置密码    UPDATE user SET plugin=&#39;mysql_native_password&#39; WHERE user=&#39;root&#39;; # 修改root用户为校验密码    exit;    # 退出MySQL执行    systemctl restart mysql # 重启mysql，执行后选择账户输入密码即可    cd /etc/mysql # 配置文件下的bind-host改为0.0.0.0，允许任意远程登录    # mysql内执行    create user &#39;example&#39;@&#39;%&#39; identified by &#39;example123&#39;; # 创建用户    grant all on example.* to &#39;example&#39;@&#39;%&#39;; # 指定访问数据库    flush privileges; # 更新配置信息</code></pre><h3 id="安装node"><a href="#安装node" class="headerlink" title="安装node"></a>安装node</h3><pre><code class="shell">    # 下载nvm的包放入/home/pi(也就是~的指向路径)    sudo nano ~/.bashrc    # 修改.bashrc文件在后面写入以下内容        export NVM_DIR=&quot;$HOME/.nvm/nvm-0.38.0&quot;        [ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \. &quot;$NVM_DIR/nvm.sh&quot;  # This loads nvm        [ -s &quot;$NVM_DIR/bash_completion&quot; ] &amp;&amp; \. &quot;$NVM_DIR/bash_completion&quot;  # This loads nvm bash_completion    # 执行命令更新配置    source ~/.bashrc    nvm install 16.19.0    nvm install 14.21.2    nvm install 8.17.0</code></pre><h2 id="部署node项目（pm2）"><a href="#部署node项目（pm2）" class="headerlink" title="部署node项目（pm2）"></a>部署node项目（pm2）</h2><pre><code class="shell">    # 安装pm2    npm install pm2 -g    # 查看版本    pm2 --version    # 启动服务    pm2 start app.js    # 停止服务    pm2 stop app.js    # 查看服务状态    pm2 monit    pm2 list    # 同步进程    pm2 save</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Media Server</title>
      <link href="/2023/10/10/media-server/"/>
      <url>/2023/10/10/media-server/</url>
      
        <content type="html"><![CDATA[<p>关于推流、拉流命令行控制及开发依赖<br>&#x2F;&#x2F; 后管地址 127.0.0.1:8000&#x2F;admin&#x2F;<br>&#x2F;&#x2F; 接口：<a href="http://127.0.0.1:8000/api/server">http://127.0.0.1:8000/api/server</a> &#x2F;&#x2F; 性能线程监控<br>&#x2F;&#x2F; 接口：<a href="http://127.0.0.1:8000/api/streams">http://127.0.0.1:8000/api/streams</a> &#x2F;&#x2F; 查询推流列表</p><h2 id="ffmpeg-shell-x2F-cmd"><a href="#ffmpeg-shell-x2F-cmd" class="headerlink" title="ffmpeg(shell&#x2F;cmd)"></a>ffmpeg(shell&#x2F;cmd)</h2><h3 id="基础命令"><a href="#基础命令" class="headerlink" title="基础命令"></a>基础命令</h3><pre><code class="shell">    # dshow可以用来抓取摄像头、采集卡、麦克风等，vfwcap主要用来采集摄像头类设备，gdigrab则是抓取Windows窗口程序    ffmpeg -list_devices true -f dshow -i dummy # 查询可用dshow设备    -f vfwcap -i &quot;0&quot; # 启用摄像头    -f gdigrab -i desktop 启用桌面录制 -f gdigrab -i title=&quot;&quot; # 启用应用录制    -f dshow -i video=&quot;&quot; 指定video设备 -f dshow -i audio=&quot;&quot; # 指定audio设备    -re -stream_loop -1 # 重复    -vcodec libx264 -preset ultrafast # video指定解码配置    -acodec libmp3lame -ar 44100 -ac 1 # audio指定解码配置    -c:v libx264 -preset ultrafast  # vfwcap摄像头使用video配置</code></pre><h3 id="RTMP协议推流"><a href="#RTMP协议推流" class="headerlink" title="RTMP协议推流"></a>RTMP协议推流</h3><pre><code class="shell">    # 重复推流test.mp4至rtmp接口    ffmpeg -re -stream_loop -1 -i test.mp4 -vcodec libx264 -preset ultrafast -f flv rtmp://localhost:1935/stream/test    # 摄像头推流至rtmp接口（不包含acodec）    ffmpeg -f vfwcap  -i &quot;0&quot; -c:v libx264 -preset ultrafast -f flv rtmp://localhost:1935/media/home    # 桌面desktop推流至rtmp接口（不包含acodec）    ffmpeg -f gdigrab -i desktop -vcodec libx264 -preset ultrafast -f flv rtmp://192.168.52.51:1935/media/home</code></pre><h3 id="ffmpeg本地"><a href="#ffmpeg本地" class="headerlink" title="ffmpeg本地"></a>ffmpeg本地</h3><pre><code class="shell">    # 从视频中提取音频    ffmpeg.exe -i aa.mp4 -vn -c:a copy output.aac    # -vn 表示去掉视频， -c:a copy表示不改变音频编码，直接拷贝。    # 进行指定时间截图    ffmpeg.exe -ss 0:8:34 -i aa.mp4 -vframes 1 -q:v 2 output.jpg    # -vframes1表示只截取一帧， -q:v2表示输出的图片质量，通常范围在1到5之间（1 为最高质量）    # 为音频添加封面    ffmpeg -loop 1 -i cover.jpg -i input.mp3 -c:v libx264 -c:a aac -b:a 192k -shortest output.mp4    # 以上命令中，有两个输入文件，一个是封面图片 cover.jpg，另一个是音频文件 input.mp3。-loop1参数表示图片无限循环，  -shortest参数表示音频文件结束时，输出视频也随之结束。    # MP4 转 M3U8    ffmpeg -i input.mp4 -c:v libx264 -c:a aac -strict -2 -f hls -hlslistsize 2 -hls_time 15 output.m3u8    # 该命令将 input.mp4 视频文件每15秒生成一个 ts 文件，并最后生成一个 m3u8 文件，m3u8 文件则作为 ts 的索引文件。    # 屏幕录制并保存成文件    ffmpeg -f gdigrab -i desktop eguid.mp4    # 转流（rtsp转rtmp为例）    ffmpeg -i rtsp://184.72.239.149/vod/mp4://BigBuckBunny_175k.mov -rtsp_transport tcp -vcodec h264 -acodec aac -f flv rtmp://localhost:1935/rtmp/eguid    # 拉流    ffmpeg -i rtmp://eguid.cc:1935/rtmp/eguid -vcodec h264 -f flv -acodec aac -ac 2 eguid.flv</code></pre><h2 id="win命令控制"><a href="#win命令控制" class="headerlink" title="win命令控制"></a>win命令控制</h2><pre><code class="shell">    # 命令前+start新开命令窗口执行    tasklist # 查询所有进程    tasklist /fi &quot;imagename eq ffmpeg.exe&quot; # 根据名字查询进程    taskkill /f /im ffmpeg.exe # 根据进程名结束进程    taskkill /pid 13044 -f # 根据pid值结束进程</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>树状表Sql</title>
      <link href="/2023/08/30/treesql/"/>
      <url>/2023/08/30/treesql/</url>
      
        <content type="html"><![CDATA[<p>只记录了左右值和路径值的树型结构，个人感觉路径值更好用一点</p><h2 id="左右值-lft-rgt"><a href="#左右值-lft-rgt" class="headerlink" title="左右值(lft, rgt)"></a>左右值(lft, rgt)</h2><pre><code>查询很好用，但是新增删除时需要操作执行整个表的内容，存储失败时难以回滚，还会有并发冲突的问题，只适合内容稳定修改较少的表类型</code></pre><h3 id="新增"><a href="#新增" class="headerlink" title="新增"></a>新增</h3><pre><code class="java">// +----+-------------+-------+--------+-----+-----+----------+-------------+// | id | name        | value | type   | lft | rgt | parentId | valuePrefix |// +----+-------------+-------+--------+-----+-----+----------+-------------+// |  1 | SYSTEM_NAME | 0     | system |   1 |  28 | NULL     | sys:        |// |  2 | 系统维护    | 0     | menu   |   2 |  21 |        1 | sys:0:      |// |  3 | 人员管理    | 1     | page   |  22 |  27 |        1 | sys:0:      |// |  4 | 组织管理    | 0     | page   |   3 |   4 |        2 | sys:0:0:    |// |  5 | 角色管理    | 1     | page   |   5 |  10 |        2 | sys:0:0:    |// |  6 | 权限管理    | 2     | page   |  11 |  16 |        2 | sys:0:0:    |// |  7 | 操作日志    | 3     | page   |  17 |  18 |        2 | sys:0:0:    |// |  8 | 系统设置    | 4     | page   |  19 |  20 |        2 | sys:0:0:    |// |  9 | 新增        | 0     | button |   6 |   7 |        5 | sys:0:0:1:  |// | 10 | 新增        | 0     | button |  12 |  13 |        6 | sys:0:0:2:  |// | 11 | 编辑        | 1     | button |   8 |   9 |        5 | sys:0:0:1:  |// | 12 | 编辑        | 1     | button |  14 |  15 |        6 | sys:0:0:2:  |// | 13 | 新增        | 0     | button |  23 |  24 |        3 | sys:0:1:    |// | 14 | 编辑        | 1     | button |  25 |  26 |        3 | sys:0:1:    |// +----+-------------+-------+--------+-----+-----+----------+-------------+SET @lft := 7;/*新部门的左值*/SET @rgt := 8;/*新部门的右值*/SET @level := 5;/*新部门的层级*/begin;/*将插入的后续边缘的节点左右数+2*/UPDATE department SET lft=lft+2 WHERE lft &gt; @lft;UPDATE department SET rgt=rgt+2 WHERE rgt &gt;= @lft;/*插入数据*/INSERT INTO department(name,lft,rgt,level) VALUES(&#39;新部门&#39;,@lft,@rgt,level);/*新增影响行数为0时，必须回滚*/commit;/*rollback;*/</code></pre><h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><pre><code class="java">SET @lft := 7;/*要删除的节点左值*/SET @rgt := 8;/*要删除的节点右值*/begin;UPDATE department SET lft=lft-2 WHERE lft &gt; @lft;UPDATE department SET rgt=rgt-2 WHERE rgt &gt; @lft;/*删除节点*/DELETE FROM department WHERE lft=@lft AND rgt=@rgt;/*删除影响行数为0时，必须回滚*/commit;/*rollback*/</code></pre><h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><h4 id="查询所有子孙"><a href="#查询所有子孙" class="headerlink" title="查询所有子孙"></a>查询所有子孙</h4><pre><code class="java">SET @lft := 9;SET @rgt := 18;SELECT * FROM department WHERE lft BETWEEN @lft AND @rgt ORDER BY lft ASC;// `SELECT user_name FROM temp_pro_user WHERE lft &gt;= @lft AND lft &lt;= @rgt ORDER BY lft ASC`;/*例子中用BETWEEN将被查部门本身也查了出来。实际中可以用大于小于*/</code></pre><h4 id="查询下属总数"><a href="#查询下属总数" class="headerlink" title="查询下属总数"></a>查询下属总数</h4><pre><code class="java">// 总数 = (右值 - 左值 - 1) / 2</code></pre><h4 id="查询一级下属"><a href="#查询一级下属" class="headerlink" title="查询一级下属"></a>查询一级下属</h4><pre><code class="java">SET @level := 2;/*总经理的level*/SET @lft := 2;/*总经理的左值*/SET @rgt := 19;/*总经理的右值*/SELECT * FROM department WHERE lft &gt; @lft AND rgt &lt; @rgt AND level = @level+1;</code></pre><h4 id="查询祖链路径"><a href="#查询祖链路径" class="headerlink" title="查询祖链路径"></a>查询祖链路径</h4><pre><code class="java">SET @lft := 3;/*产品部左值*/SET @rgt := 8;/*产品部右值*/SELECT * FROM department WHERE lft &lt; @lft AND rgt &gt; @rgt ORDER BY lft ASC;</code></pre><h4 id="查询后转成树结构"><a href="#查询后转成树结构" class="headerlink" title="查询后转成树结构"></a>查询后转成树结构</h4><pre><code class="javascript">let list = [//模拟sql查出来的列表。    &#123;id:1,name:&#39;root&#39;,lft:1,rgt:8,level:1&#125;,    &#123;id:2,name:&#39;child&#39;,lft:2,rgt:7,level:2&#125;,    &#123;id:3,name:&#39;grandson&#39;,lft:3,rgt:4,level:3&#125;,    &#123;id:4,name:&#39;grandson2&#39;,lft:5,rgt:6,level:3&#125;];let rights = [] /*类似于一个栈结构（后进先出）*/let mp = &#123;&#125;//list.sort((a,b) =&gt; a.lft - b.lft)//如果你在sql中没有进行排序，需要在这里给他排序。list.forEach(item =&gt; &#123;    if(rights.length &gt; 0) &#123;        while(rights[rights.length-1] &lt; item.rgt) &#123;            rights.splice(-1, 1)//从rights末尾去除        &#125;    &#125;    let _level = rights.length;    item._level = _level;    mp[_level] = item.id    item.parent_id = _level - 1 in mp ? mp[_level - 1] : null;//计算出上级部门编号    item.is_leaf = item.lft === item.rgt - 1;//判断是否叶子部门    rights.push(item.rgt)&#125;)/*上级部门计算出来了，和存parent_id的效果就一样了，后面只需要递归即可*//*递归函数 示例*/let recursive = (_list, parent_id = null) =&gt; &#123;    let _tree = [];    _list.forEach(item =&gt; &#123;        if(item.parent_id === parent_id) &#123;            let childs = recursive(_list, item.id)            _tree.push(&#123;                ...item,                children: childs.length &gt; 0 ? childs : (item.isLeaf ? null : [])            &#125;)        &#125;    &#125;)    return _tree&#125;console.log(recursive(list))</code></pre><h2 id="路径值（1-x2F-2-x2F-3-x2F-4-x2F-5-x2F-6-x2F-…）"><a href="#路径值（1-x2F-2-x2F-3-x2F-4-x2F-5-x2F-6-x2F-…）" class="headerlink" title="路径值（1&#x2F;2&#x2F;3&#x2F;4&#x2F;5&#x2F;6&#x2F;…）"></a>路径值（1&#x2F;2&#x2F;3&#x2F;4&#x2F;5&#x2F;6&#x2F;…）</h2><pre><code>查询难度低，需要拼接path内容，存储基本不会出现并发冲突</code></pre><h3 id="查询-1"><a href="#查询-1" class="headerlink" title="查询"></a>查询</h3><pre><code class="java">// +----+----------+------------+// | id | userName | path       |// +----+----------+------------+// |  1 | Admin    | 0          |// |  2 | Ron      | 0/1        |// |  3 | Ron0     | 0/1/2      |// |  4 | Bio      | 0/1        |// |  5 | Ron1     | 0/1/2      |// |  6 | Bio0     | 0/1/4      |// |  7 | Bio00    | 0/1/4/6    |// |  8 | Bio000   | 0/1/4/6/7  |// +----+----------+------------+// 查询所有子结构内容(当前id: 2)const @userPath = user.path + &#39;/&#39; + user.id + &#39;%&#39;SELECT name FROM TABLENAME WHERE path like @userPath// 查询所有父结构内容(当前id: 8)const @pathArr = user.path.split(&#39;/&#39;)SELECT name FROM TABLENAME WHERE id IN @pathArr</code></pre><h3 id="查询后转树状"><a href="#查询后转树状" class="headerlink" title="查询后转树状"></a>查询后转树状</h3><pre><code class="javascript">/*递归函数 示例*/let recursive = (_list, path = 0) =&gt; &#123;    let _tree = [];    _list.forEach(item =&gt; &#123;        if(item.path === path) &#123;            let childs = recursive(_list, (path + &#39;/&#39; + item.id))            _tree.push(&#123;                ...item,                children: childs.length &gt; 0 ? childs : []            &#125;)        &#125;    &#125;)    return _tree&#125;console.log(recursive(list))</code></pre>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
